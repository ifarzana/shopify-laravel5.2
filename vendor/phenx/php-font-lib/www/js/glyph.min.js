var Glyph={glyphs:[],ratio:null,head:null,os2:null,hmtx:null,width:null,height:null,scale:1,splitPath:function(a){return a.match(/([a-z])|(-?\d+(?:\.\d+)?)/ig)},drawPath:function(b,f){var e=Glyph.splitPath(f);if(!e){return}var a=e.length;var d=0;b.beginPath();while(d<a){var c=e[d];switch(c){case"M":b.moveTo(e[++d],e[++d]);break;case"L":b.lineTo(e[++d],e[++d]);break;case"Q":b.quadraticCurveTo(e[++d],e[++d],e[++d],e[++d]);break;case"z":d++;break;default:d++}}b.fill();b.closePath()},drawSVGContours:function(b,g){if(!$.isArray(g)){Glyph.drawPath(b,g);return}var e,f,c;for(var d=0,a=g.length;d<a;d++){e=g[d];f=e.contours;c=e.transform;b.save();b.transform(c[0],c[1],c[2],c[3],c[4],c[5]);Glyph.drawSVGContours(b,f);b.restore()}},drawHorizLine:function(a,c,b){a.beginPath();a.strokeStyle=b;a.moveTo(0,c);a.lineTo(Glyph.width*Glyph.ratio,c);a.closePath();a.stroke()},draw:function(b,e,d){var c=b[0];var i=c.getContext("2d");var f=Glyph.ratio;var a=Glyph.width*Glyph.scale;var h=Glyph.height*Glyph.scale;i.clearRect(0,0,a,h);i.lineWidth=f/Glyph.scale;i.translate(0,h);i.scale(1/f,-(1/f));i.scale(Glyph.scale,Glyph.scale);i.translate(0,-Glyph.head.yMin);Glyph.drawHorizLine(i,0,"rgba(0,255,0,0.2)");Glyph.drawHorizLine(i,Glyph.os2.typoAscender,"rgba(255,0,0,0.2)");Glyph.drawHorizLine(i,-Math.abs(Glyph.os2.typoDescender),"rgba(255,0,0,0.2)");i.translate(-Glyph.head.xMin,0);i.save();var j=f*3;i.strokeStyle="rgba(0,0,0,0.5)";i.lineWidth=(f*1.5)/Glyph.scale;i.beginPath();i.moveTo(-j,-j);i.lineTo(+j,+j);i.moveTo(+j,-j);i.lineTo(-j,+j);i.closePath();i.stroke();var g=Glyph.hmtx[d][0];i.beginPath();i.moveTo(-j+g,-j);i.lineTo(+j+g,+j);i.moveTo(+j+g,-j);i.lineTo(-j+g,+j);i.closePath();i.stroke();i.restore();if(!e){return}i.beginPath();i.strokeStyle="rgba(0,0,0,0.3)";i.rect(0,0,e.xMin+e.xMax,e.yMin+e.yMax);i.closePath();i.stroke();i.strokeStyle="black";Glyph.drawSVGContours(i,e.SVGContours)},drawAll:function(){$.each(Glyph.glyphs,function(a,b){Glyph.draw($("#glyph-canvas-"+b[0]),b[1],b[0])})},resize:function(a){Glyph.scale=a/100;$.each(document.getElementsByTagName("canvas"),function(c,b){b.height=Glyph.height*Glyph.scale;b.width=Glyph.width*Glyph.scale});Glyph.drawAll()}};$(function(){Glyph.drawAll()});