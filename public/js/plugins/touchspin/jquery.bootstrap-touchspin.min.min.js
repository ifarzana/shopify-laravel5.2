!function(f){function e(d,c){return d+".touchspin_"+c}function h(b,a){return f.map(b,function(c){return e(c,a)})}var g=0;f.fn.TouchSpin=function(a){if("destroy"===a){return void this.each(function(){var i=f(this),j=i.data();f(document).off(h(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],j.spinnerid).join(" "))})}var d={min:0,max:100,initval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},c={min:"min",max:"max",initval:"init-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function at(){if(!Q.data("alreadyinitialized")){if(Q.data("alreadyinitialized",!0),g+=1,Q.data("spinnerid",g),!Q.is("input")){return void console.log("Must be an input.")}ap(),ar(),Z(),am(),aj(),ah(),af(),ad(),ac.input.css("display","block")}}function ar(){""!==ag.initval&&""===Q.val()&&Q.val(ag.initval)}function aq(j){an(j),Z();var i=ac.input.val();""!==i&&(i=Number(ac.input.val()),ac.input.val(i.toFixed(ag.decimals)))}function ap(){ag=f.extend({},d,O,ao(),a)}function ao(){var i={};return f.each(c,function(j,l){var k="bts-"+l;Q.is("[data-"+k+"]")&&(i[j]=Q.data(k))}),i}function an(i){ag=f.extend({},ag,i)}function am(){var j=Q.val(),i=Q.parent();""!==j&&(j=Number(j).toFixed(ag.decimals)),Q.data("initvalue",j).val(j),Q.addClass("form-control"),i.hasClass("input-group")?al(i):ak()}function al(i){i.addClass("bootstrap-touchspin");var o,n,m=Q.prev(),l=Q.next(),k='<span class="input-group-addon bootstrap-touchspin-prefix">'+ag.prefix+"</span>",j='<span class="input-group-addon bootstrap-touchspin-postfix">'+ag.postfix+"</span>";m.hasClass("input-group-btn")?(o='<button class="'+ag.buttondown_class+' bootstrap-touchspin-down" type="button">'+ag.buttondown_txt+"</button>",m.append(o)):(o='<span class="input-group-btn"><button class="'+ag.buttondown_class+' bootstrap-touchspin-down" type="button">'+ag.buttondown_txt+"</button></span>",f(o).insertBefore(Q)),l.hasClass("input-group-btn")?(n='<button class="'+ag.buttonup_class+' bootstrap-touchspin-up" type="button">'+ag.buttonup_txt+"</button>",l.prepend(n)):(n='<span class="input-group-btn"><button class="'+ag.buttonup_class+' bootstrap-touchspin-up" type="button">'+ag.buttonup_txt+"</button></span>",f(n).insertAfter(Q)),f(k).insertBefore(Q),f(j).insertAfter(Q),ae=i}function ak(){var i;i=ag.verticalbuttons?'<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+ag.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+ag.postfix+'</span><span class="input-group-btn-vertical"><button class="'+ag.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+ag.verticalupclass+'"></i></button><button class="'+ag.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+ag.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+ag.buttondown_class+' bootstrap-touchspin-down" type="button">'+ag.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+ag.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+ag.postfix+'</span><span class="input-group-btn"><button class="'+ag.buttonup_class+' bootstrap-touchspin-up" type="button">'+ag.buttonup_txt+"</button></span></div>",ae=f(i).insertBefore(Q),f(".bootstrap-touchspin-prefix",ae).after(Q),Q.hasClass("input-sm")?ae.addClass("input-group-sm"):Q.hasClass("input-lg")&&ae.addClass("input-group-lg")}function aj(){ac={down:f(".bootstrap-touchspin-down",ae),up:f(".bootstrap-touchspin-up",ae),input:f("input",ae),prefix:f(".bootstrap-touchspin-prefix",ae).addClass(ag.prefix_extraclass),postfix:f(".bootstrap-touchspin-postfix",ae).addClass(ag.postfix_extraclass)}}function ah(){""===ag.prefix&&ac.prefix.hide(),""===ag.postfix&&ac.postfix.hide()}function af(){Q.on("keydown",function(j){var i=j.keyCode||j.which;38===i?("up"!==b&&(V(),P()),j.preventDefault()):40===i&&("down"!==b&&(T(),R()),j.preventDefault())}),Q.on("keyup",function(j){var i=j.keyCode||j.which;38===i?ai():40===i&&ai()}),Q.on("blur",function(){Z()}),ac.down.on("keydown",function(j){var i=j.keyCode||j.which;(32===i||13===i)&&("down"!==b&&(T(),R()),j.preventDefault())}),ac.down.on("keyup",function(j){var i=j.keyCode||j.which;(32===i||13===i)&&ai()}),ac.up.on("keydown",function(j){var i=j.keyCode||j.which;(32===i||13===i)&&("up"!==b&&(V(),P()),j.preventDefault())}),ac.up.on("keyup",function(j){var i=j.keyCode||j.which;(32===i||13===i)&&ai()}),ac.down.on("mousedown.touchspin",function(i){ac.down.off("touchstart.touchspin"),Q.is(":disabled")||(T(),R(),i.preventDefault(),i.stopPropagation())}),ac.down.on("touchstart.touchspin",function(i){ac.down.off("mousedown.touchspin"),Q.is(":disabled")||(T(),R(),i.preventDefault(),i.stopPropagation())}),ac.up.on("mousedown.touchspin",function(i){ac.up.off("touchstart.touchspin"),Q.is(":disabled")||(V(),P(),i.preventDefault(),i.stopPropagation())}),ac.up.on("touchstart.touchspin",function(i){ac.up.off("mousedown.touchspin"),Q.is(":disabled")||(V(),P(),i.preventDefault(),i.stopPropagation())}),ac.up.on("mouseout touchleave touchend touchcancel",function(i){b&&(i.stopPropagation(),ai())}),ac.down.on("mouseout touchleave touchend touchcancel",function(i){b&&(i.stopPropagation(),ai())}),ac.down.on("mousemove touchmove",function(i){b&&(i.stopPropagation(),i.preventDefault())}),ac.up.on("mousemove touchmove",function(i){b&&(i.stopPropagation(),i.preventDefault())}),f(document).on(h(["mouseup","touchend","touchcancel"],g).join(" "),function(i){b&&(i.preventDefault(),ai())}),f(document).on(h(["mousemove","touchmove","scroll","scrollstart"],g).join(" "),function(i){b&&(i.preventDefault(),ai())}),Q.on("mousewheel DOMMouseScroll",function(j){if(ag.mousewheel&&Q.is(":focus")){var i=j.originalEvent.wheelDelta||-j.originalEvent.deltaY||-j.originalEvent.detail;j.stopPropagation(),j.preventDefault(),0>i?T():V()}})}function ad(){Q.on("touchspin.uponce",function(){ai(),V()}),Q.on("touchspin.downonce",function(){ai(),T()}),Q.on("touchspin.startupspin",function(){P()}),Q.on("touchspin.startdownspin",function(){R()}),Q.on("touchspin.stopspin",function(){ai()}),Q.on("touchspin.updatesettings",function(j,i){aq(i)})}function ab(i){switch(ag.forcestepdivisibility){case"round":return(Math.round(i/ag.step)*ag.step).toFixed(ag.decimals);case"floor":return(Math.floor(i/ag.step)*ag.step).toFixed(ag.decimals);case"ceil":return(Math.ceil(i/ag.step)*ag.step).toFixed(ag.decimals);default:return i}}function Z(){var j,i,k;j=Q.val(),""!==j&&(ag.decimals>0&&"."===j||(i=parseFloat(j),isNaN(i)&&(i=0),k=i,i.toString()!==j&&(k=i),i<ag.min&&(k=ag.min),i>ag.max&&(k=ag.max),k=ab(k),Number(j).toString()!==k.toString()&&(Q.val(k),Q.trigger("change"))))}function X(){if(ag.booster){var i=Math.pow(2,Math.floor(N/ag.boostat))*ag.step;return ag.maxboostedstep&&i>ag.maxboostedstep&&(i=ag.maxboostedstep,aa=Math.round(aa/i)*i),Math.max(ag.step,i)}return ag.step}function V(){Z(),aa=parseFloat(ac.input.val()),isNaN(aa)&&(aa=0);var j=aa,i=X();aa+=i,aa>ag.max&&(aa=ag.max,Q.trigger("touchspin.on.max"),ai()),ac.input.val(Number(aa).toFixed(ag.decimals)),j!==aa&&Q.trigger("change")}function T(){Z(),aa=parseFloat(ac.input.val()),isNaN(aa)&&(aa=0);var j=aa,i=X();aa-=i,aa<ag.min&&(aa=ag.min,Q.trigger("touchspin.on.min"),ai()),ac.input.val(aa.toFixed(ag.decimals)),j!==aa&&Q.trigger("change")}function R(){ai(),N=0,b="down",Q.trigger("touchspin.on.startspin"),Q.trigger("touchspin.on.startdownspin"),U=setTimeout(function(){Y=setInterval(function(){N++,T()},ag.stepinterval)},ag.stepintervaldelay)}function P(){ai(),N=0,b="up",Q.trigger("touchspin.on.startspin"),Q.trigger("touchspin.on.startupspin"),S=setTimeout(function(){W=setInterval(function(){N++,V()},ag.stepinterval)},ag.stepintervaldelay)}function ai(){switch(clearTimeout(U),clearTimeout(S),clearInterval(Y),clearInterval(W),b){case"up":Q.trigger("touchspin.on.stopupspin"),Q.trigger("touchspin.on.stopspin");break;case"down":Q.trigger("touchspin.on.stopdownspin"),Q.trigger("touchspin.on.stopspin")}N=0,b=!1}var ag,ae,ac,aa,Y,W,U,S,Q=f(this),O=Q.data(),N=0,b=!1;at()})}}(jQuery);