(function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()})(this,function(){function C(c,d){var a,f=document.createElement(c||"div");for(a in d){f[a]=d[a]}return f}function x(c){for(var d=1,a=arguments.length;a>d;d++){c.appendChild(arguments[d])}return c}function q(F,u,p,f){var c=["opacity",u,~~(100*F),p,f].join("-"),d=0.01+100*(p/f),E=Math.max(1-(1-F)/u*(100-d),F),G=B.substring(0,B.indexOf("Animation")).toLowerCase(),h=G&&"-"+G+"-"||"";return z[c]||(g.insertRule("@"+h+"keyframes "+c+"{0%{opacity:"+E+"}"+d+"%{opacity:"+F+"}"+(d+0.01)+"%{opacity:1}"+(d+u)%100+"%{opacity:"+F+"}100%{opacity:"+E+"}}",g.cssRules.length),z[c]=1),c}function k(c,f){var a,h,d=c.style;for(f=f.charAt(0).toUpperCase()+f.slice(1),h=0;y.length>h;h++){if(a=y[h]+f,void 0!==d[a]){return a}}return void 0!==d[f]?f:void 0}function b(c,d){for(var a in d){c.style[k(c,a)||a]=d[a]}return c}function j(c){for(var d=1;arguments.length>d;d++){var a=arguments[d];for(var f in a){void 0===c[f]&&(c[f]=a[f])}}return c}function A(a,c){return"string"==typeof a?a:a[c%a.length]}function D(a){this.opts=j(a||{},D.defaults,w)}function m(){function a(d,c){return C("<"+d+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}g.addRule(".spin-vml","behavior:url(#default#VML)"),D.prototype.lines=function(G,h){function f(){return b(a("group",{coordsize:r+" "+r,coordorigin:-F+" "+-F}),{width:r,height:r})}function H(d,n,c){x(e,x(b(f(),{rotation:360/h.lines*d+"deg",left:~~n}),x(b(a("roundrect",{arcsize:h.corners}),{width:F,height:h.width,left:h.radius,top:-h.width>>1,filter:c}),a("fill",{color:A(h.color,d),opacity:h.opacity}),a("stroke",{opacity:0}))))}var i,F=h.length+h.width,r=2*F,E=2*-(h.width+h.length)+"px",e=b(f(),{position:"absolute",top:E,left:E});if(h.shadow){for(i=1;h.lines>=i;i++){H(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(i=1;h.lines>=i;i++){H(i)}return x(G,e)},D.prototype.opacity=function(d,h,c,l){var f=d.firstChild;l=l.shadow&&l.lines||0,f&&f.childNodes.length>h+l&&(f=f.childNodes[h+l],f=f&&f.firstChild,f=f&&f.firstChild,f&&(f.opacity=c))}}var B,y=["webkit","Moz","ms","O"],z={},g=function(){var a=C("style",{type:"text/css"});return x(document.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),w={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:0.25,fps:20,zIndex:2000000000,className:"spinner",top:"50%",left:"50%",position:"absolute"};D.defaults={},j(D.prototype,{spin:function(I){this.stop();var F=this,u=F.opts,t=F.el=b(C(0,{className:u.className}),{position:u.position,width:0,zIndex:u.zIndex});if(u.radius+u.length+u.width,b(t,{left:u.left,top:u.top}),I&&I.insertBefore(t,I.firstChild||null),t.setAttribute("role","progressbar"),F.lines(t,F.opts),!B){var L,M=0,E=(u.lines-1)*(1-u.direction)/2,J=u.fps,K=J/u.speed,r=(1-u.opacity)/(K*u.trail/100),H=K/u.lines;(function G(){M++;for(var a=0;u.lines>a;a++){L=Math.max(1-(M+(u.lines-a)*H)%K*r,u.opacity),F.opacity(t,a*u.direction+E,L,u)}F.timeout=F.el&&setTimeout(G,~~(1000/J))})()}return F},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(p,h){function e(d,c){return b(C(),{position:"absolute",width:h.length+h.width+"px",height:h.width+"px",background:d,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/h.lines*f+h.rotate)+"deg) translate("+h.radius+"px,0)",borderRadius:(h.corners*h.width>>1)+"px"})}for(var a,f=0,i=(h.lines-1)*(1-h.direction)/2;h.lines>f;f++){a=b(C(),{position:"absolute",top:1+~(h.width/2)+"px",transform:h.hwaccel?"translate3d(0,0,0)":"",opacity:h.opacity,animation:B&&q(h.opacity,h.trail,i+f*h.direction,h.lines)+" "+1/h.speed+"s linear infinite"}),h.shadow&&x(a,b(e("#000","0 0 4px #000"),{top:"2px"})),x(p,x(a,e(A(h.color,f),"0 0 1px rgba(0,0,0,.1)")))}return p},opacity:function(c,d,a){c.childNodes.length>d&&(c.childNodes[d].style.opacity=a)}});var v=b(C("group"),{behavior:"url(#default#VML)"});return !k(v,"transform")&&v.adj?m():B=k(v,"animation"),D});