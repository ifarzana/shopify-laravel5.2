/*!
 Tinycon - A small library for manipulating the Favicon
 Tom Moor, http://tommoor.com
 Copyright (c) 2012 Tom Moor
 @license MIT Licensed
 @version 0.6.3
 */
(function(){var a={};var x=null;var s=null;var n=null;var c=null;var d={};var l=window.devicePixelRatio||1;var m=16*l;var f={width:7,height:9,font:10*l+"px arial",colour:"#ffffff",background:"#F03D25",fallback:true,crossOrigin:true,abbreviate:true};var q=(function(){var r=navigator.userAgent.toLowerCase();return function(y){return r.indexOf(y)!==-1}}());var v={ie:q("msie"),chrome:q("chrome"),webkit:q("chrome")||q("safari"),safari:q("safari")&&!q("chrome"),mozilla:q("mozilla")&&!q("chrome")&&!q("safari")};var j=function(){var y=document.getElementsByTagName("link");for(var z=0,r=y.length;z<r;z++){if((y[z].getAttribute("rel")||"").match(/\bicon\b/)){return y[z]}}return false};var i=function(){var y=document.getElementsByTagName("link");var A=document.getElementsByTagName("head")[0];for(var z=0,r=y.length;z<r;z++){var B=(typeof(y[z])!=="undefined");if(B&&(y[z].getAttribute("rel")||"").match(/\bicon\b/)){A.removeChild(y[z])}}};var h=function(){if(!s||!x){var r=j();s=x=r?r.getAttribute("href"):"/favicon.ico"}return x};var b=function(){if(!c){c=document.createElement("canvas");c.width=m;c.height=m}return c};var o=function(r){i();var y=document.createElement("link");y.type="image/x-icon";y.rel="icon";y.href=r;document.getElementsByTagName("head")[0].appendChild(y)};var e=function(r){if(window.console){window.console.log(r)}};var w=function(r,z){if(!b().getContext||v.ie||v.safari||d.fallback==="force"){return t(r)}var y=b().getContext("2d");var z=z||"#000000";var A=h();n=document.createElement("img");n.onload=function(){y.clearRect(0,0,m,m);y.drawImage(n,0,0,n.width,n.height,0,0,m,m);if((r+"").length>0){g(y,r,z)}k()};if(!A.match(/^data/)&&d.crossOrigin){n.crossOrigin="anonymous"}n.src=A};var t=function(y){if(d.fallback){var r=document.title;if(r[0]==="("){r=r.slice(r.indexOf(" "))}if((y+"").length>0){document.title="("+y+") "+r}else{document.title=r}}};var g=function(A,F,y){if(typeof F=="number"&&F>99&&d.abbreviate){F=p(F)}var D=(F+"").length-1;var z=d.width*l+(6*l*D),H=d.height*l;var E=m-H,B=m-z-l,r=16*l,G=16*l,C=2*l;A.font=(v.webkit?"bold ":"")+d.font;A.fillStyle=d.background;A.strokeStyle=d.background;A.lineWidth=l;A.beginPath();A.moveTo(B+C,E);A.quadraticCurveTo(B,E,B,E+C);A.lineTo(B,r-C);A.quadraticCurveTo(B,r,B+C,r);A.lineTo(G-C,r);A.quadraticCurveTo(G,r,G,r-C);A.lineTo(G,E+C);A.quadraticCurveTo(G,E,G-C,E);A.closePath();A.fill();A.beginPath();A.strokeStyle="rgba(0,0,0,0.3)";A.moveTo(B+C/2,r);A.lineTo(G-C/2,r);A.stroke();A.fillStyle=d.colour;A.textAlign="right";A.textBaseline="top";A.fillText(F,l===2?29:15,v.mozilla?7*l:6*l)};var k=function(){if(!b().getContext){return}o(b().toDataURL())};var p=function(r){var z=[["G",1000000000],["M",1000000],["k",1000]];for(var y=0;y<z.length;++y){if(r>=z[y][1]){r=u(r/z[y][1])+z[y][0];break}}return r};var u=function(z,r){var y=new Number(z);return y.toFixed(r)};a.setOptions=function(y){d={};for(var r in f){d[r]=y.hasOwnProperty(r)?y[r]:f[r]}return this};a.setImage=function(r){x=r;k();return this};a.setBubble=function(r,y){r=r||"";w(r,y);return this};a.reset=function(){o(s)};a.setOptions(f);window.Tinycon=a;if(typeof define==="function"&&define.amd){define(a)}})();