(function(a){var b={set:{colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,focus:1},get:{selectedRegions:1,selectedMarkers:1,mapObject:1,regionName:1}};a.fn.vectorMap=function(d){var e,c,e=this.children(".jvectormap-container").data("mapObject");if(d==="addMap"){jvm.Map.maps[arguments[1]]=arguments[2]}else{if((d==="set"||d==="get")&&b[d][arguments[1]]){c=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1);return e[d+c].apply(e,Array.prototype.slice.call(arguments,2))}else{d=d||{};d.container=this;e=new jvm.Map(d)}}return this}})(jQuery);
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.9
 *
 * Requires: jQuery 1.2.2+
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a}else{a(jQuery)}}}(function(c){var d=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k=("onwheel" in document||document.documentMode>=9)?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice,j,b;if(c.event.fixHooks){for(var e=d.length;e;){c.event.fixHooks[d[--e]]=c.event.mouseHooks}}var f=c.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener){for(var m=k.length;m;){this.addEventListener(k[--m],l,false)}}else{this.onmousewheel=l}c.data(this,"mousewheel-line-height",f.getLineHeight(this));c.data(this,"mousewheel-page-height",f.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var m=k.length;m;){this.removeEventListener(k[--m],l,false)}}else{this.onmousewheel=null}},getLineHeight:function(i){return parseInt(c(i)["offsetParent" in c.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(i){return c(i).height()},settings:{adjustOldDeltas:true}};c.fn.extend({mousewheel:function(i){return i?this.bind("mousewheel",i):this.trigger("mousewheel")},unmousewheel:function(i){return this.unbind("mousewheel",i)}});function l(i){var n=i||window.event,r=h.call(arguments,1),t=0,p=0,o=0,q=0;i=c.event.fix(n);i.type="mousewheel";if("detail" in n){o=n.detail*-1}if("wheelDelta" in n){o=n.wheelDelta}if("wheelDeltaY" in n){o=n.wheelDeltaY}if("wheelDeltaX" in n){p=n.wheelDeltaX*-1}if("axis" in n&&n.axis===n.HORIZONTAL_AXIS){p=o*-1;o=0}t=o===0?p:o;if("deltaY" in n){o=n.deltaY*-1;t=o}if("deltaX" in n){p=n.deltaX;if(o===0){t=p*-1}}if(o===0&&p===0){return}if(n.deltaMode===1){var s=c.data(this,"mousewheel-line-height");t*=s;o*=s;p*=s}else{if(n.deltaMode===2){var m=c.data(this,"mousewheel-page-height");t*=m;o*=m;p*=m}}q=Math.max(Math.abs(o),Math.abs(p));if(!b||q<b){b=q;if(a(n,q)){b/=40}}if(a(n,q)){t/=40;p/=40;o/=40}t=Math[t>=1?"floor":"ceil"](t/b);p=Math[p>=1?"floor":"ceil"](p/b);o=Math[o>=1?"floor":"ceil"](o/b);i.deltaX=p;i.deltaY=o;i.deltaFactor=b;i.deltaMode=0;r.unshift(i,t,p,o);if(j){clearTimeout(j)}j=setTimeout(g,200);return(c.event.dispatch||c.event.handle).apply(this,r)}function g(){b=null}function a(m,i){return f.settings.adjustOldDeltas&&m.type==="mousewheel"&&i%120===0}}));var jvm={inherits:function(c,b){function a(){}a.prototype=b.prototype;c.prototype=new a();c.prototype.constructor=c;c.parentClass=b},mixin:function(b,a){var c;for(c in a.prototype){if(a.prototype.hasOwnProperty(c)){b.prototype[c]=a.prototype[c]}}},min:function(a){var c=Number.MAX_VALUE,b;if(a instanceof Array){for(b=0;b<a.length;b++){if(a[b]<c){c=a[b]}}}else{for(b in a){if(a[b]<c){c=a[b]}}}return c},max:function(b){var a=Number.MIN_VALUE,c;if(b instanceof Array){for(c=0;c<b.length;c++){if(b[c]>a){a=b[c]}}}else{for(c in b){if(b[c]>a){a=b[c]}}}return a},keys:function(a){var c=[],b;for(b in a){c.push(b)}return c},values:function(b){var a=[],d,c;for(c=0;c<arguments.length;c++){b=arguments[c];for(d in b){a.push(b[d])}}return a},whenImageLoaded:function(c){var b=new jvm.$.Deferred(),a=jvm.$("<img/>");a.error(function(){b.reject()}).load(function(){b.resolve(a)});a.attr("src",c);return b},isImageUrl:function(a){return/\.\w{3,4}$/.test(a)}};jvm.$=jQuery;if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){var b;if(this==null){throw new TypeError('"this" is null or not defined')}var e=Object(this);var a=e.length>>>0;if(a===0){return -1}var f=+d||0;if(Math.abs(f)===Infinity){f=0}if(f>=a){return -1}b=Math.max(f>=0?f:a-Math.abs(f),0);while(b<a){if(b in e&&e[b]===c){return b}b++}return -1}}jvm.AbstractElement=function(b,a){this.node=this.createElement(b);this.name=b;this.properties={};if(a){this.set(a)}};jvm.AbstractElement.prototype.set=function(c,b){var a;if(typeof c==="object"){for(a in c){this.properties[a]=c[a];this.applyAttr(a,c[a])}}else{this.properties[c]=b;this.applyAttr(c,b)}};jvm.AbstractElement.prototype.get=function(a){return this.properties[a]};jvm.AbstractElement.prototype.applyAttr=function(b,a){this.node.setAttribute(b,a)};jvm.AbstractElement.prototype.remove=function(){jvm.$(this.node).remove()};jvm.AbstractCanvasElement=function(b,c,a){this.container=b;this.setSize(c,a);this.rootElement=new jvm[this.classPrefix+"GroupElement"]();this.node.appendChild(this.rootElement.node);this.container.appendChild(this.node)};jvm.AbstractCanvasElement.prototype.add=function(a,b){b=b||this.rootElement;b.add(a);a.canvas=this};jvm.AbstractCanvasElement.prototype.addPath=function(a,c,d){var b=new jvm[this.classPrefix+"PathElement"](a,c);this.add(b,d);return b};jvm.AbstractCanvasElement.prototype.addCircle=function(a,c,d){var b=new jvm[this.classPrefix+"CircleElement"](a,c);this.add(b,d);return b};jvm.AbstractCanvasElement.prototype.addImage=function(a,c,d){var b=new jvm[this.classPrefix+"ImageElement"](a,c);this.add(b,d);return b};jvm.AbstractCanvasElement.prototype.addText=function(a,c,d){var b=new jvm[this.classPrefix+"TextElement"](a,c);this.add(b,d);return b};jvm.AbstractCanvasElement.prototype.addGroup=function(b){var a=new jvm[this.classPrefix+"GroupElement"]();if(b){b.node.appendChild(a.node)}else{this.node.appendChild(a.node)}a.canvas=this;return a};jvm.AbstractShapeElement=function(b,a,c){this.style=c||{};this.style.current=this.style.current||{};this.isHovered=false;this.isSelected=false;this.updateStyle()};jvm.AbstractShapeElement.prototype.setStyle=function(c,b){var a={};if(typeof c==="object"){a=c}else{a[c]=b}jvm.$.extend(this.style.current,a);this.updateStyle()};jvm.AbstractShapeElement.prototype.updateStyle=function(){var a={};jvm.AbstractShapeElement.mergeStyles(a,this.style.initial);jvm.AbstractShapeElement.mergeStyles(a,this.style.current);if(this.isHovered){jvm.AbstractShapeElement.mergeStyles(a,this.style.hover)}if(this.isSelected){jvm.AbstractShapeElement.mergeStyles(a,this.style.selected);if(this.isHovered){jvm.AbstractShapeElement.mergeStyles(a,this.style.selectedHover)}}this.set(a)};jvm.AbstractShapeElement.mergeStyles=function(b,c){var a;c=c||{};for(a in c){if(c[a]===null){delete b[a]}else{b[a]=c[a]}}};jvm.SVGElement=function(b,a){jvm.SVGElement.parentClass.apply(this,arguments)};jvm.inherits(jvm.SVGElement,jvm.AbstractElement);jvm.SVGElement.svgns="http://www.w3.org/2000/svg";jvm.SVGElement.prototype.createElement=function(a){return document.createElementNS(jvm.SVGElement.svgns,a)};jvm.SVGElement.prototype.addClass=function(a){this.node.setAttribute("class",a)};jvm.SVGElement.prototype.getElementCtr=function(a){return jvm["SVG"+a]};jvm.SVGElement.prototype.getBBox=function(){return this.node.getBBox()};jvm.SVGGroupElement=function(){jvm.SVGGroupElement.parentClass.call(this,"g")};jvm.inherits(jvm.SVGGroupElement,jvm.SVGElement);jvm.SVGGroupElement.prototype.add=function(a){this.node.appendChild(a.node)};jvm.SVGCanvasElement=function(b,c,a){this.classPrefix="SVG";jvm.SVGCanvasElement.parentClass.call(this,"svg");this.defsElement=new jvm.SVGElement("defs");this.node.appendChild(this.defsElement.node);jvm.AbstractCanvasElement.apply(this,arguments)};jvm.inherits(jvm.SVGCanvasElement,jvm.SVGElement);jvm.mixin(jvm.SVGCanvasElement,jvm.AbstractCanvasElement);jvm.SVGCanvasElement.prototype.setSize=function(b,a){this.width=b;this.height=a;this.node.setAttribute("width",b);this.node.setAttribute("height",a)};jvm.SVGCanvasElement.prototype.applyTransformParams=function(c,b,a){this.scale=c;this.transX=b;this.transY=a;this.rootElement.node.setAttribute("transform","scale("+c+") translate("+b+", "+a+")")};jvm.SVGShapeElement=function(b,a,c){jvm.SVGShapeElement.parentClass.call(this,b,a);jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement);jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement);jvm.SVGShapeElement.prototype.applyAttr=function(a,c){var d,e,b=this;if(a==="fill"&&jvm.isImageUrl(c)){if(!jvm.SVGShapeElement.images[c]){jvm.whenImageLoaded(c).then(function(f){e=new jvm.SVGElement("image");e.node.setAttributeNS("http://www.w3.org/1999/xlink","href",c);e.applyAttr("x","0");e.applyAttr("y","0");e.applyAttr("width",f[0].width);e.applyAttr("height",f[0].height);d=new jvm.SVGElement("pattern");d.applyAttr("id","image"+jvm.SVGShapeElement.imageCounter);d.applyAttr("x",0);d.applyAttr("y",0);d.applyAttr("width",f[0].width/2);d.applyAttr("height",f[0].height/2);d.applyAttr("viewBox","0 0 "+f[0].width+" "+f[0].height);d.applyAttr("patternUnits","userSpaceOnUse");d.node.appendChild(e.node);b.canvas.defsElement.node.appendChild(d.node);jvm.SVGShapeElement.images[c]=jvm.SVGShapeElement.imageCounter++;b.applyAttr("fill","url(#image"+jvm.SVGShapeElement.images[c]+")")})}else{this.applyAttr("fill","url(#image"+jvm.SVGShapeElement.images[c]+")")}}else{jvm.SVGShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}};jvm.SVGShapeElement.imageCounter=1;jvm.SVGShapeElement.images={};jvm.SVGPathElement=function(a,b){jvm.SVGPathElement.parentClass.call(this,"path",a,b);this.node.setAttribute("fill-rule","evenodd")};jvm.inherits(jvm.SVGPathElement,jvm.SVGShapeElement);jvm.SVGCircleElement=function(a,b){jvm.SVGCircleElement.parentClass.call(this,"circle",a,b)};jvm.inherits(jvm.SVGCircleElement,jvm.SVGShapeElement);jvm.SVGImageElement=function(a,b){jvm.SVGImageElement.parentClass.call(this,"image",a,b)};jvm.inherits(jvm.SVGImageElement,jvm.SVGShapeElement);jvm.SVGImageElement.prototype.applyAttr=function(a,c){var b=this;if(a=="image"){jvm.whenImageLoaded(c).then(function(d){b.node.setAttributeNS("http://www.w3.org/1999/xlink","href",c);b.width=d[0].width;b.height=d[0].height;b.applyAttr("width",b.width);b.applyAttr("height",b.height);b.applyAttr("x",b.cx-b.width/2);b.applyAttr("y",b.cy-b.height/2);jvm.$(b.node).trigger("imageloaded",[d])})}else{if(a=="cx"){this.cx=c;if(this.width){this.applyAttr("x",c-this.width/2)}}else{if(a=="cy"){this.cy=c;if(this.height){this.applyAttr("y",c-this.height/2)}}else{jvm.SVGImageElement.parentClass.prototype.applyAttr.apply(this,arguments)}}}};jvm.SVGTextElement=function(a,b){jvm.SVGTextElement.parentClass.call(this,"text",a,b)};jvm.inherits(jvm.SVGTextElement,jvm.SVGShapeElement);jvm.SVGTextElement.prototype.applyAttr=function(a,b){if(a==="text"){this.node.textContent=b}else{jvm.SVGTextElement.parentClass.prototype.applyAttr.apply(this,arguments)}};jvm.VMLElement=function(b,a){if(!jvm.VMLElement.VMLInitialized){jvm.VMLElement.initializeVML()}jvm.VMLElement.parentClass.apply(this,arguments)};jvm.inherits(jvm.VMLElement,jvm.AbstractElement);jvm.VMLElement.VMLInitialized=false;jvm.VMLElement.initializeVML=function(){try{if(!document.namespaces.rvml){document.namespaces.add("rvml","urn:schemas-microsoft-com:vml")}jvm.VMLElement.prototype.createElement=function(b){return document.createElement("<rvml:"+b+' class="rvml">')}}catch(a){jvm.VMLElement.prototype.createElement=function(b){return document.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");jvm.VMLElement.VMLInitialized=true};jvm.VMLElement.prototype.getElementCtr=function(a){return jvm["VML"+a]};jvm.VMLElement.prototype.addClass=function(a){jvm.$(this.node).addClass(a)};jvm.VMLElement.prototype.applyAttr=function(a,b){this.node[a]=b};jvm.VMLElement.prototype.getBBox=function(){var a=jvm.$(this.node);return{x:a.position().left/this.canvas.scale,y:a.position().top/this.canvas.scale,width:a.width()/this.canvas.scale,height:a.height()/this.canvas.scale}};jvm.VMLGroupElement=function(){jvm.VMLGroupElement.parentClass.call(this,"group");this.node.style.left="0px";this.node.style.top="0px";this.node.coordorigin="0 0"};jvm.inherits(jvm.VMLGroupElement,jvm.VMLElement);jvm.VMLGroupElement.prototype.add=function(a){this.node.appendChild(a.node)};jvm.VMLCanvasElement=function(b,c,a){this.classPrefix="VML";jvm.VMLCanvasElement.parentClass.call(this,"group");jvm.AbstractCanvasElement.apply(this,arguments);this.node.style.position="absolute"};jvm.inherits(jvm.VMLCanvasElement,jvm.VMLElement);jvm.mixin(jvm.VMLCanvasElement,jvm.AbstractCanvasElement);jvm.VMLCanvasElement.prototype.setSize=function(e,b){var f,a,d,c;this.width=e;this.height=b;this.node.style.width=e+"px";this.node.style.height=b+"px";this.node.coordsize=e+" "+b;this.node.coordorigin="0 0";if(this.rootElement){f=this.rootElement.node.getElementsByTagName("shape");for(d=0,c=f.length;d<c;d++){f[d].coordsize=e+" "+b;f[d].style.width=e+"px";f[d].style.height=b+"px"}a=this.node.getElementsByTagName("group");for(d=0,c=a.length;d<c;d++){a[d].coordsize=e+" "+b;a[d].style.width=e+"px";a[d].style.height=b+"px"}}};jvm.VMLCanvasElement.prototype.applyTransformParams=function(c,b,a){this.scale=c;this.transX=b;this.transY=a;this.rootElement.node.coordorigin=(this.width-b-this.width/100)+","+(this.height-a-this.height/100);this.rootElement.node.coordsize=this.width/c+","+this.height/c};jvm.VMLShapeElement=function(b,a){jvm.VMLShapeElement.parentClass.call(this,b,a);this.fillElement=new jvm.VMLElement("fill");this.strokeElement=new jvm.VMLElement("stroke");this.node.appendChild(this.fillElement.node);this.node.appendChild(this.strokeElement.node);this.node.stroked=false;jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.VMLShapeElement,jvm.VMLElement);jvm.mixin(jvm.VMLShapeElement,jvm.AbstractShapeElement);jvm.VMLShapeElement.prototype.applyAttr=function(a,b){switch(a){case"fill":this.node.fillcolor=b;break;case"fill-opacity":this.fillElement.node.opacity=Math.round(b*100)+"%";break;case"stroke":if(b==="none"){this.node.stroked=false}else{this.node.stroked=true}this.node.strokecolor=b;break;case"stroke-opacity":this.strokeElement.node.opacity=Math.round(b*100)+"%";break;case"stroke-width":if(parseInt(b,10)===0){this.node.stroked=false}else{this.node.stroked=true}this.node.strokeweight=b;break;case"d":this.node.path=jvm.VMLPathElement.pathSvgToVml(b);break;default:jvm.VMLShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}};jvm.VMLPathElement=function(a,b){var c=new jvm.VMLElement("skew");jvm.VMLPathElement.parentClass.call(this,"shape",a,b);this.node.coordorigin="0 0";c.node.on=true;c.node.matrix="0.01,0,0,0.01,0,0";c.node.offset="0,0";this.node.appendChild(c.node)};jvm.inherits(jvm.VMLPathElement,jvm.VMLShapeElement);jvm.VMLPathElement.prototype.applyAttr=function(a,b){if(a==="d"){this.node.path=jvm.VMLPathElement.pathSvgToVml(b)}else{jvm.VMLShapeElement.prototype.applyAttr.call(this,a,b)}};jvm.VMLPathElement.pathSvgToVml=function(d){var a=0,e=0,c,b;d=d.replace(/(-?\d+)e(-?\d+)/g,"0");return d.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(k,j,m,g){m=m.replace(/(\d)-/g,"$1,-").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g,",").split(",");if(!m[0]){m.shift()}for(var h=0,f=m.length;h<f;h++){m[h]=Math.round(100*m[h])}switch(j){case"m":a+=m[0];e+=m[1];return"t"+m.join(",");case"M":a=m[0];e=m[1];return"m"+m.join(",");case"l":a+=m[0];e+=m[1];return"r"+m.join(",");case"L":a=m[0];e=m[1];return"l"+m.join(",");case"h":a+=m[0];return"r"+m[0]+",0";case"H":a=m[0];return"l"+a+","+e;case"v":e+=m[0];return"r0,"+m[0];case"V":e=m[0];return"l"+a+","+e;case"c":c=a+m[m.length-4];b=e+m[m.length-3];a+=m[m.length-2];e+=m[m.length-1];return"v"+m.join(",");case"C":c=m[m.length-4];b=m[m.length-3];a=m[m.length-2];e=m[m.length-1];return"c"+m.join(",");case"s":m.unshift(e-b);m.unshift(a-c);c=a+m[m.length-4];b=e+m[m.length-3];a+=m[m.length-2];e+=m[m.length-1];return"v"+m.join(",");case"S":m.unshift(e+e-b);m.unshift(a+a-c);c=m[m.length-4];b=m[m.length-3];a=m[m.length-2];e=m[m.length-1];return"c"+m.join(",")}return""}).replace(/z/g,"e")};jvm.VMLCircleElement=function(a,b){jvm.VMLCircleElement.parentClass.call(this,"oval",a,b)};jvm.inherits(jvm.VMLCircleElement,jvm.VMLShapeElement);jvm.VMLCircleElement.prototype.applyAttr=function(a,b){switch(a){case"r":this.node.style.width=b*2+"px";this.node.style.height=b*2+"px";this.applyAttr("cx",this.get("cx")||0);this.applyAttr("cy",this.get("cy")||0);break;case"cx":if(!b){return}this.node.style.left=b-(this.get("r")||0)+"px";break;case"cy":if(!b){return}this.node.style.top=b-(this.get("r")||0)+"px";break;default:jvm.VMLCircleElement.parentClass.prototype.applyAttr.call(this,a,b)}};jvm.VectorCanvas=function(b,c,a){this.mode=window.SVGAngle?"svg":"vml";if(this.mode=="svg"){this.impl=new jvm.SVGCanvasElement(b,c,a)}else{this.impl=new jvm.VMLCanvasElement(b,c,a)}this.impl.mode=this.mode;return this.impl};jvm.SimpleScale=function(a){this.scale=a};jvm.SimpleScale.prototype.getValue=function(a){return a};jvm.OrdinalScale=function(a){this.scale=a};jvm.OrdinalScale.prototype.getValue=function(a){return this.scale[a]};jvm.OrdinalScale.prototype.getTicks=function(){var b=[],a;for(a in this.scale){b.push({label:a,value:this.scale[a]})}return b};jvm.NumericScale=function(d,a,b,c){this.scale=[];a=a||"linear";if(d){this.setScale(d)}if(a){this.setNormalizeFunction(a)}if(typeof b!=="undefined"){this.setMin(b)}if(typeof c!=="undefined"){this.setMax(c)}};jvm.NumericScale.prototype={setMin:function(a){this.clearMinValue=a;if(typeof this.normalize==="function"){this.minValue=this.normalize(a)}else{this.minValue=a}},setMax:function(a){this.clearMaxValue=a;if(typeof this.normalize==="function"){this.maxValue=this.normalize(a)}else{this.maxValue=a}},setScale:function(b){var a;this.scale=[];for(a=0;a<b.length;a++){this.scale[a]=[b[a]]}},setNormalizeFunction:function(a){if(a==="polynomial"){this.normalize=function(b){return Math.pow(b,0.2)}}else{if(a==="linear"){delete this.normalize}else{this.normalize=a}}this.setMin(this.clearMinValue);this.setMax(this.clearMaxValue)},getValue:function(d){var g=[],e=0,a,b=0,f;if(typeof this.normalize==="function"){d=this.normalize(d)}for(b=0;b<this.scale.length-1;b++){a=this.vectorLength(this.vectorSubtract(this.scale[b+1],this.scale[b]));g.push(a);e+=a}f=(this.maxValue-this.minValue)/e;for(b=0;b<g.length;b++){g[b]*=f}b=0;d-=this.minValue;while(d-g[b]>=0){d-=g[b];b++}if(b==this.scale.length-1){d=this.vectorToNum(this.scale[b])}else{d=(this.vectorToNum(this.vectorAdd(this.scale[b],this.vectorMult(this.vectorSubtract(this.scale[b+1],this.scale[b]),(d)/(g[b])))))}return d},vectorToNum:function(a){var b=0,c;for(c=0;c<a.length;c++){b+=Math.round(a[c])*Math.pow(256,a.length-c-1)}return b},vectorSubtract:function(d,c){var a=[],b;for(b=0;b<d.length;b++){a[b]=d[b]-c[b]}return a},vectorAdd:function(d,c){var a=[],b;for(b=0;b<d.length;b++){a[b]=d[b]+c[b]}return a},vectorMult:function(b,c){var a=[],d;for(d=0;d<b.length;d++){a[d]=b[d]*c}return a},vectorLength:function(b){var a=0,c;for(c=0;c<b.length;c++){a+=b[c]*b[c]}return Math.sqrt(a)},getTicks:function(){var a=5,e=[this.clearMinValue,this.clearMaxValue],d=e[1]-e[0],h=Math.pow(10,Math.floor(Math.log(d/a)/Math.LN10)),g=a/d*h,f=[],c,b;if(g<=0.15){h*=10}else{if(g<=0.35){h*=5}else{if(g<=0.75){h*=2}}}e[0]=Math.floor(e[0]/h)*h;e[1]=Math.ceil(e[1]/h)*h;c=e[0];while(c<=e[1]){if(c==e[0]){b=this.clearMinValue}else{if(c==e[1]){b=this.clearMaxValue}else{b=c}}f.push({label:c,value:this.getValue(b)});c+=h}return f}};jvm.ColorScale=function(a,b,c,d){jvm.ColorScale.parentClass.apply(this,arguments)};jvm.inherits(jvm.ColorScale,jvm.NumericScale);jvm.ColorScale.prototype.setScale=function(b){var a;for(a=0;a<b.length;a++){this.scale[a]=jvm.ColorScale.rgbToArray(b[a])}};jvm.ColorScale.prototype.getValue=function(a){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,a))};jvm.ColorScale.arrayToRgb=function(a){var b="#",e,c;for(c=0;c<a.length;c++){e=a[c].toString(16);b+=e.length==1?"0"+e:e}return b};jvm.ColorScale.numToRgb=function(a){a=a.toString(16);while(a.length<6){a="0"+a}return"#"+a};jvm.ColorScale.rgbToArray=function(a){a=a.substr(1);return[parseInt(a.substr(0,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(4,2),16)]};jvm.Legend=function(a){this.params=a||{};this.map=this.params.map;this.series=this.params.series;this.body=jvm.$("<div/>");this.body.addClass("jvectormap-legend");if(this.params.cssClass){this.body.addClass(this.params.cssClass)}if(a.vertical){this.map.legendCntVertical.append(this.body)}else{this.map.legendCntHorizontal.append(this.body)}this.render()};jvm.Legend.prototype.render=function(){var f=this.series.scale.getTicks(),d,a=jvm.$("<div/>").addClass("jvectormap-legend-inner"),c,e,b;this.body.html("");if(this.params.title){this.body.append(jvm.$("<div/>").addClass("jvectormap-legend-title").html(this.params.title))}this.body.append(a);for(d=0;d<f.length;d++){c=jvm.$("<div/>").addClass("jvectormap-legend-tick");e=jvm.$("<div/>").addClass("jvectormap-legend-tick-sample");switch(this.series.params.attribute){case"fill":if(jvm.isImageUrl(f[d].value)){e.css("background","url("+f[d].value+")")}else{e.css("background",f[d].value)}break;case"stroke":e.css("background",f[d].value);break;case"image":e.css("background","url("+f[d].value+") no-repeat center center");break;case"r":jvm.$("<div/>").css({"border-radius":f[d].value,border:this.map.params.markerStyle.initial["stroke-width"]+"px "+this.map.params.markerStyle.initial.stroke+" solid",width:f[d].value*2+"px",height:f[d].value*2+"px",background:this.map.params.markerStyle.initial.fill}).appendTo(e);break}c.append(e);b=f[d].label;if(this.params.labelRender){b=this.params.labelRender(b)}c.append(jvm.$("<div>"+b+" </div>").addClass("jvectormap-legend-tick-text"));a.append(c)}a.append(jvm.$("<div/>").css("clear","both"))};jvm.DataSeries=function(d,b,c){var a;d=d||{};d.attribute=d.attribute||"fill";this.elements=b;this.params=d;this.map=c;if(d.attributes){this.setAttributes(d.attributes)}if(jvm.$.isArray(d.scale)){a=(d.attribute==="fill"||d.attribute==="stroke")?jvm.ColorScale:jvm.NumericScale;this.scale=new a(d.scale,d.normalizeFunction,d.min,d.max)}else{if(d.scale){this.scale=new jvm.OrdinalScale(d.scale)}else{this.scale=new jvm.SimpleScale(d.scale)}}this.values=d.values||{};this.setValues(this.values);if(this.params.legend){this.legend=new jvm.Legend($.extend({map:this.map,series:this},this.params.legend))}};jvm.DataSeries.prototype={setAttributes:function(c,a){var b=c,d;if(typeof c=="string"){if(this.elements[c]){this.elements[c].setStyle(this.params.attribute,a)}}else{for(d in b){if(this.elements[d]){this.elements[d].element.setStyle(this.params.attribute,b[d])}}}},setValues:function(b){var a=-Number.MAX_VALUE,d=Number.MAX_VALUE,e,f,c={};if(!(this.scale instanceof jvm.OrdinalScale)&&!(this.scale instanceof jvm.SimpleScale)){if(typeof this.params.min==="undefined"||typeof this.params.max==="undefined"){for(f in b){e=parseFloat(b[f]);if(e>a){a=e}if(e<d){d=e}}}if(typeof this.params.min==="undefined"){this.scale.setMin(d);this.params.min=d}else{this.scale.setMin(this.params.min)}if(typeof this.params.max==="undefined"){this.scale.setMax(a);this.params.max=a}else{this.scale.setMax(this.params.max)}for(f in b){if(f!="indexOf"){e=parseFloat(b[f]);if(!isNaN(e)){c[f]=this.scale.getValue(e)}else{c[f]=this.elements[f].element.style.initial[this.params.attribute]}}}}else{for(f in b){if(b[f]){c[f]=this.scale.getValue(b[f])}else{c[f]=this.elements[f].element.style.initial[this.params.attribute]}}}this.setAttributes(c);jvm.$.extend(this.values,b)},clear:function(){var b,a={};for(b in this.values){if(this.elements[b]){a[b]=this.elements[b].element.shape.style.initial[this.params.attribute]}}this.setAttributes(a);this.values={}},setScale:function(a){this.scale.setScale(a);if(this.values){this.setValues(this.values)}},setNormalizeFunction:function(a){this.scale.setNormalizeFunction(a);if(this.values){this.setValues(this.values)}}};jvm.Proj={degRad:180/Math.PI,radDeg:Math.PI/180,radius:6381372,sgn:function(a){if(a>0){return 1}else{if(a<0){return -1}else{return a}}},mill:function(b,a,d){return{x:this.radius*(a-d)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+0.4*b)*this.radDeg))/0.8}},mill_inv:function(a,d,b){return{lat:(2.5*Math.atan(Math.exp(0.8*d/this.radius))-5*Math.PI/8)*this.degRad,lng:(b*this.radDeg+a/this.radius)*this.degRad}},merc:function(b,a,d){return{x:this.radius*(a-d)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+b*Math.PI/360))}},merc_inv:function(a,d,b){return{lat:(2*Math.atan(Math.exp(d/this.radius))-Math.PI/2)*this.degRad,lng:(b*this.radDeg+a/this.radius)*this.degRad}},aea:function(m,o,l){var k=0,d=l*this.radDeg,i=29.5*this.radDeg,g=45.5*this.radDeg,p=m*this.radDeg,j=o*this.radDeg,f=(Math.sin(i)+Math.sin(g))/2,b=Math.cos(i)*Math.cos(i)+2*f*Math.sin(i),e=f*(j-d),h=Math.sqrt(b-2*f*Math.sin(p))/f,a=Math.sqrt(b-2*f*Math.sin(k))/f;return{x:h*Math.sin(e)*this.radius,y:-(a-h*Math.cos(e))*this.radius}},aea_inv:function(e,h,m){var p=e/this.radius,o=h/this.radius,l=0,d=m*this.radDeg,k=29.5*this.radDeg,i=45.5*this.radDeg,g=(Math.sin(k)+Math.sin(i))/2,b=Math.cos(k)*Math.cos(k)+2*g*Math.sin(k),a=Math.sqrt(b-2*g*Math.sin(l))/g,j=Math.sqrt(p*p+(a-o)*(a-o)),f=Math.atan(p/(a-o));return{lat:(Math.asin((b-j*j*g*g)/(2*g)))*this.degRad,lng:(d+f/g)*this.degRad}},lcc:function(k,l,j){var h=0,b=j*this.radDeg,i=l*this.radDeg,g=33*this.radDeg,e=45*this.radDeg,o=k*this.radDeg,d=Math.log(Math.cos(g)*(1/Math.cos(e)))/Math.log(Math.tan(Math.PI/4+e/2)*(1/Math.tan(Math.PI/4+g/2))),m=(Math.cos(g)*Math.pow(Math.tan(Math.PI/4+g/2),d))/d,f=m*Math.pow(1/Math.tan(Math.PI/4+o/2),d),a=m*Math.pow(1/Math.tan(Math.PI/4+h/2),d);return{x:f*Math.sin(d*(i-b))*this.radius,y:-(a-f*Math.cos(d*(i-b)))*this.radius}},lcc_inv:function(d,g,l){var o=d/this.radius,m=g/this.radius,k=0,b=l*this.radDeg,j=33*this.radDeg,h=45*this.radDeg,f=Math.log(Math.cos(j)*(1/Math.cos(h)))/Math.log(Math.tan(Math.PI/4+h/2)*(1/Math.tan(Math.PI/4+j/2))),p=(Math.cos(j)*Math.pow(Math.tan(Math.PI/4+j/2),f))/f,a=p*Math.pow(1/Math.tan(Math.PI/4+k/2),f),i=this.sgn(f)*Math.sqrt(o*o+(a-m)*(a-m)),e=Math.atan(o/(a-m));return{lat:(2*Math.atan(Math.pow(p/i,1/f))-Math.PI/2)*this.degRad,lng:(b+e/f)*this.degRad}}};jvm.MapObject=function(a){};jvm.MapObject.prototype.getLabelText=function(a){var b;if(this.config.label){if(typeof this.config.label.render==="function"){b=this.config.label.render(a)}else{b=a}}else{b=null}return b};jvm.MapObject.prototype.getLabelOffsets=function(a){var b;if(this.config.label){if(typeof this.config.label.offsets==="function"){b=this.config.label.offsets(a)}else{if(typeof this.config.label.offsets==="object"){b=this.config.label.offsets[a]}}}return b||[0,0]};jvm.MapObject.prototype.setHovered=function(a){if(this.isHovered!==a){this.isHovered=a;this.shape.isHovered=a;this.shape.updateStyle();if(this.label){this.label.isHovered=a;this.label.updateStyle()}}};jvm.MapObject.prototype.setSelected=function(a){if(this.isSelected!==a){this.isSelected=a;this.shape.isSelected=a;this.shape.updateStyle();if(this.label){this.label.isSelected=a;this.label.updateStyle()}jvm.$(this.shape).trigger("selected",[a])}};jvm.MapObject.prototype.setStyle=function(){this.shape.setStyle.apply(this.shape,arguments)};jvm.MapObject.prototype.remove=function(){this.shape.remove();if(this.label){this.label.remove()}};jvm.Region=function(b){var e,d,c,a,f;this.config=b;this.map=this.config.map;this.shape=b.canvas.addPath({d:b.path,"data-code":b.code},b.style,b.canvas.rootElement);this.shape.addClass("jvectormap-region jvectormap-element");e=this.shape.getBBox();d=this.getLabelText(b.code);if(this.config.label&&d){c=this.getLabelOffsets(b.code);this.labelX=e.x+e.width/2+c[0];this.labelY=e.y+e.height/2+c[1];this.label=b.canvas.addText({text:d,"text-anchor":"middle","alignment-baseline":"central",x:this.labelX,y:this.labelY,"data-code":b.code},b.labelStyle,b.labelsGroup);this.label.addClass("jvectormap-region jvectormap-element")}};jvm.inherits(jvm.Region,jvm.MapObject);jvm.Region.prototype.updateLabelPosition=function(){if(this.label){this.label.set({x:this.labelX*this.map.scale+this.map.transX*this.map.scale,y:this.labelY*this.map.scale+this.map.transY*this.map.scale})}};jvm.Marker=function(a){var c,b;this.config=a;this.map=this.config.map;this.isImage=!!this.config.style.initial.image;this.createShape();c=this.getLabelText(a.index);if(this.config.label&&c){this.offsets=this.getLabelOffsets(a.index);this.labelX=a.cx/this.map.scale-this.map.transX;this.labelY=a.cy/this.map.scale-this.map.transY;this.label=a.canvas.addText({text:c,"data-index":a.index,dy:"0.6ex",x:this.labelX,y:this.labelY},a.labelStyle,a.labelsGroup);this.label.addClass("jvectormap-marker jvectormap-element")}};jvm.inherits(jvm.Marker,jvm.MapObject);jvm.Marker.prototype.createShape=function(){var a=this;if(this.shape){this.shape.remove()}this.shape=this.config.canvas[this.isImage?"addImage":"addCircle"]({"data-index":this.config.index,cx:this.config.cx,cy:this.config.cy},this.config.style,this.config.group);this.shape.addClass("jvectormap-marker jvectormap-element");if(this.isImage){jvm.$(this.shape.node).on("imageloaded",function(){a.updateLabelPosition()})}};jvm.Marker.prototype.updateLabelPosition=function(){if(this.label){this.label.set({x:this.labelX*this.map.scale+this.offsets[0]+this.map.transX*this.map.scale+5+(this.isImage?(this.shape.width||0)/2:this.shape.properties.r),y:this.labelY*this.map.scale+this.map.transY*this.map.scale+this.offsets[1]})}};jvm.Marker.prototype.setStyle=function(b,a){var c;jvm.Marker.parentClass.prototype.setStyle.apply(this,arguments);if(b==="r"){this.updateLabelPosition()}c=!!this.shape.get("image");if(c!=this.isImage){this.isImage=c;this.config.style=jvm.$.extend(true,{},this.shape.style);this.createShape()}};jvm.Map=function(c){var b=this,a;this.params=jvm.$.extend(true,{},jvm.Map.defaultParams,c);if(!jvm.Map.maps[this.params.map]){throw new Error("Attempt to use map which was not loaded: "+this.params.map)}this.mapData=jvm.Map.maps[this.params.map];this.markers={};this.regions={};this.regionsColors={};this.regionsData={};this.container=jvm.$("<div>").addClass("jvectormap-container");if(this.params.container){this.params.container.append(this.container)}this.container.data("mapObject",this);this.defaultWidth=this.mapData.width;this.defaultHeight=this.mapData.height;this.setBackgroundColor(this.params.backgroundColor);this.onResize=function(){b.updateSize()};jvm.$(window).resize(this.onResize);for(a in jvm.Map.apiEvents){if(this.params[a]){this.container.bind(jvm.Map.apiEvents[a]+".jvectormap",this.params[a])}}this.canvas=new jvm.VectorCanvas(this.container[0],this.width,this.height);if(("ontouchstart" in window)||(window.DocumentTouch&&document instanceof DocumentTouch)){if(this.params.bindTouchEvents){this.bindContainerTouchEvents()}}this.bindContainerEvents();this.bindElementEvents();this.createTip();if(this.params.zoomButtons){this.bindZoomButtons()}this.createRegions();this.createMarkers(this.params.markers||{});this.updateSize();if(this.params.focusOn){if(typeof this.params.focusOn==="string"){this.params.focusOn={region:this.params.focusOn}}else{if(jvm.$.isArray(this.params.focusOn)){this.params.focusOn={regions:this.params.focusOn}}}this.setFocus(this.params.focusOn)}if(this.params.selectedRegions){this.setSelectedRegions(this.params.selectedRegions)}if(this.params.selectedMarkers){this.setSelectedMarkers(this.params.selectedMarkers)}this.legendCntHorizontal=jvm.$("<div/>").addClass("jvectormap-legend-cnt jvectormap-legend-cnt-h");this.legendCntVertical=jvm.$("<div/>").addClass("jvectormap-legend-cnt jvectormap-legend-cnt-v");this.container.append(this.legendCntHorizontal);this.container.append(this.legendCntVertical);if(this.params.series){this.createSeries()}};jvm.Map.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,setBackgroundColor:function(a){this.container.css("background-color",a)},resize:function(){var a=this.baseScale;if(this.width/this.height>this.defaultWidth/this.defaultHeight){this.baseScale=this.height/this.defaultHeight;this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)}else{this.baseScale=this.width/this.defaultWidth;this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)}this.scale*=this.baseScale/a;this.transX*=this.baseScale/a;this.transY*=this.baseScale/a},updateSize:function(){this.width=this.container.width();this.height=this.container.height();this.resize();this.canvas.setSize(this.width,this.height);this.applyTransform()},reset:function(){var b,a;for(b in this.series){for(a=0;a<this.series[b].length;a++){this.series[b][a].clear()}}this.scale=this.baseScale;this.transX=this.baseTransX;this.transY=this.baseTransY;this.applyTransform()},applyTransform:function(){var c,b,a,d;if(this.defaultWidth*this.scale<=this.width){c=(this.width-this.defaultWidth*this.scale)/(2*this.scale);a=(this.width-this.defaultWidth*this.scale)/(2*this.scale)}else{c=0;a=(this.width-this.defaultWidth*this.scale)/this.scale}if(this.defaultHeight*this.scale<=this.height){b=(this.height-this.defaultHeight*this.scale)/(2*this.scale);d=(this.height-this.defaultHeight*this.scale)/(2*this.scale)}else{b=0;d=(this.height-this.defaultHeight*this.scale)/this.scale}if(this.transY>b){this.transY=b}else{if(this.transY<d){this.transY=d}}if(this.transX>c){this.transX=c}else{if(this.transX<a){this.transX=a}}this.canvas.applyTransformParams(this.scale,this.transX,this.transY);if(this.markers){this.repositionMarkers()}this.repositionLabels();this.container.trigger("viewportChange",[this.scale/this.baseScale,this.transX,this.transY])},bindContainerEvents:function(){var b=false,c,a,d=this;if(this.params.panOnDrag){this.container.mousemove(function(f){if(b){d.transX-=(c-f.pageX)/d.scale;d.transY-=(a-f.pageY)/d.scale;d.applyTransform();c=f.pageX;a=f.pageY}return false}).mousedown(function(f){b=true;c=f.pageX;a=f.pageY;return false});this.onContainerMouseUp=function(){b=false};jvm.$("body").mouseup(this.onContainerMouseUp)}if(this.params.zoomOnScroll){this.container.mousewheel(function(h,l,f,e){var k=jvm.$(d.container).offset(),j=h.pageX-k.left,i=h.pageY-k.top,g=Math.pow(1+d.params.zoomOnScrollSpeed/1000,h.deltaFactor*h.deltaY);d.tip.hide();d.setScale(d.scale*g,j,i);h.preventDefault()})}},bindContainerTouchEvents:function(){var b,e,a=this,i,h,d,c,g,f=function(m){var l=m.originalEvent.touches,o,n,k,j;if(m.type=="touchstart"){g=0}if(l.length==1){if(g==1){k=a.transX;j=a.transY;a.transX-=(i-l[0].pageX)/a.scale;a.transY-=(h-l[0].pageY)/a.scale;a.applyTransform();a.tip.hide();if(k!=a.transX||j!=a.transY){m.preventDefault()}}i=l[0].pageX;h=l[0].pageY}else{if(l.length==2){if(g==2){n=Math.sqrt(Math.pow(l[0].pageX-l[1].pageX,2)+Math.pow(l[0].pageY-l[1].pageY,2))/e;a.setScale(b*n,d,c);a.tip.hide();m.preventDefault()}else{o=jvm.$(a.container).offset();if(l[0].pageX>l[1].pageX){d=l[1].pageX+(l[0].pageX-l[1].pageX)/2}else{d=l[0].pageX+(l[1].pageX-l[0].pageX)/2}if(l[0].pageY>l[1].pageY){c=l[1].pageY+(l[0].pageY-l[1].pageY)/2}else{c=l[0].pageY+(l[1].pageY-l[0].pageY)/2}d-=o.left;c-=o.top;b=a.scale;e=Math.sqrt(Math.pow(l[0].pageX-l[1].pageX,2)+Math.pow(l[0].pageY-l[1].pageY,2))}}}g=l.length};jvm.$(this.container).bind("touchstart",f);jvm.$(this.container).bind("touchmove",f)},bindElementEvents:function(){var b=this,a;this.container.mousemove(function(){a=true});this.container.delegate("[class~='jvectormap-element']","mouseover mouseout",function(j){var d=jvm.$(this).attr("class").baseVal||jvm.$(this).attr("class"),g=d.indexOf("jvectormap-region")===-1?"marker":"region",h=g=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),f=g=="region"?b.regions[h].element:b.markers[h].element,c=g=="region"?b.mapData.paths[h].name:(b.markers[h].config.name||""),i=jvm.$.Event(g+"TipShow.jvectormap"),k=jvm.$.Event(g+"Over.jvectormap");if(j.type=="mouseover"){b.container.trigger(k,[h]);if(!k.isDefaultPrevented()){f.setHovered(true)}b.tip.text(c);b.container.trigger(i,[b.tip,h]);if(!i.isDefaultPrevented()){b.tip.show();b.tipWidth=b.tip.width();b.tipHeight=b.tip.height()}}else{f.setHovered(false);b.tip.hide();b.container.trigger(g+"Out.jvectormap",[h])}});this.container.delegate("[class~='jvectormap-element']","mousedown",function(){a=false});this.container.delegate("[class~='jvectormap-element']","mouseup",function(){var d=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),f=d.indexOf("jvectormap-region")===-1?"marker":"region",g=f=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),c=jvm.$.Event(f+"Click.jvectormap"),e=f=="region"?b.regions[g].element:b.markers[g].element;if(!a){b.container.trigger(c,[g]);if((f==="region"&&b.params.regionsSelectable)||(f==="marker"&&b.params.markersSelectable)){if(!c.isDefaultPrevented()){if(b.params[f+"sSelectableOne"]){b.clearSelected(f+"s")}e.setSelected(!e.isSelected)}}}})},bindZoomButtons:function(){var a=this;jvm.$("<div/>").addClass("jvectormap-zoomin").text("+").appendTo(this.container);jvm.$("<div/>").addClass("jvectormap-zoomout").html("&#x2212;").appendTo(this.container);this.container.find(".jvectormap-zoomin").click(function(){a.setScale(a.scale*a.params.zoomStep,a.width/2,a.height/2,false,a.params.zoomAnimate)});this.container.find(".jvectormap-zoomout").click(function(){a.setScale(a.scale/a.params.zoomStep,a.width/2,a.height/2,false,a.params.zoomAnimate)})},createTip:function(){var a=this;this.tip=jvm.$("<div/>").addClass("jvectormap-tip").appendTo(jvm.$("body"));this.container.mousemove(function(d){var c=d.pageX-15-a.tipWidth,b=d.pageY-15-a.tipHeight;if(c<5){c=d.pageX+15}if(b<5){b=d.pageY+15}a.tip.css({left:c,top:b})})},setScale:function(s,c,a,m,f){var n=jvm.$.Event("zoom.jvectormap"),q,k=this,o=0,h=Math.abs(Math.round((s-this.scale)*60/Math.max(s,this.scale))),l,p,e,g,j,r,d,b,t=new jvm.$.Deferred();if(s>this.params.zoomMax*this.baseScale){s=this.params.zoomMax*this.baseScale}else{if(s<this.params.zoomMin*this.baseScale){s=this.params.zoomMin*this.baseScale}}if(typeof c!="undefined"&&typeof a!="undefined"){zoomStep=s/this.scale;if(m){d=c+this.defaultWidth*(this.width/(this.defaultWidth*s))/2;b=a+this.defaultHeight*(this.height/(this.defaultHeight*s))/2}else{d=this.transX-(zoomStep-1)/s*c;b=this.transY-(zoomStep-1)/s*a}}if(f&&h>0){l=this.scale;p=(s-l)/h;e=this.transX*this.scale;j=this.transY*this.scale;g=(d*s-e)/h;r=(b*s-j)/h;q=setInterval(function(){o+=1;k.scale=l+p*o;k.transX=(e+g*o)/k.scale;k.transY=(j+r*o)/k.scale;k.applyTransform();if(o==h){clearInterval(q);k.container.trigger(n,[s/k.baseScale]);t.resolve()}},10)}else{this.transX=d;this.transY=b;this.scale=s;this.applyTransform();this.container.trigger(n,[s/this.baseScale]);t.resolve()}return t},setFocus:function(d){var g,c,f,b,e,a;d=d||{};if(d.region){b=[d.region]}else{if(d.regions){b=d.regions}}if(b){for(e=0;e<b.length;e++){if(this.regions[b[e]]){c=this.regions[b[e]].element.shape.getBBox();if(c){if(typeof g=="undefined"){g=c}else{f={x:Math.min(g.x,c.x),y:Math.min(g.y,c.y),width:Math.max(g.x+g.width,c.x+c.width)-Math.min(g.x,c.x),height:Math.max(g.y+g.height,c.y+c.height)-Math.min(g.y,c.y)};g=f}}}}return this.setScale(Math.min(this.width/g.width,this.height/g.height),-(g.x+g.width/2),-(g.y+g.height/2),true,d.animate)}else{if(d.lat&&d.lng){a=this.latLngToPoint(d.lat,d.lng);d.x=this.transX-a.x/this.scale;d.y=this.transY-a.y/this.scale}else{if(d.x&&d.y){d.x*=-this.defaultWidth;d.y*=-this.defaultHeight}}return this.setScale(d.scale*this.baseScale,d.x,d.y,true,d.animate)}},getSelected:function(c){var a,b=[];for(a in this[c]){if(this[c][a].element.isSelected){b.push(a)}}return b},getSelectedRegions:function(){return this.getSelected("regions")},getSelectedMarkers:function(){return this.getSelected("markers")},setSelected:function(b,c){var a;if(typeof c!="object"){c=[c]}if(jvm.$.isArray(c)){for(a=0;a<c.length;a++){this[b][c[a]].element.setSelected(true)}}else{for(a in c){this[b][a].element.setSelected(!!c[a])}}},setSelectedRegions:function(a){this.setSelected("regions",a)},setSelectedMarkers:function(a){this.setSelected("markers",a)},clearSelected:function(d){var a={},c=this.getSelected(d),b;for(b=0;b<c.length;b++){a[c[b]]=false}this.setSelected(d,a)},clearSelectedRegions:function(){this.clearSelected("regions")},clearSelectedMarkers:function(){this.clearSelected("markers")},getMapObject:function(){return this},getRegionName:function(a){return this.mapData.paths[a].name},createRegions:function(){var a,c,b=this;this.regionLabelsGroup=this.regionLabelsGroup||this.canvas.addGroup();for(a in this.mapData.paths){c=new jvm.Region({map:this,path:this.mapData.paths[a].path,code:a,style:jvm.$.extend(true,{},this.params.regionStyle),labelStyle:jvm.$.extend(true,{},this.params.regionLabelStyle),canvas:this.canvas,labelsGroup:this.regionLabelsGroup,label:this.canvas.mode!="vml"?(this.params.labels&&this.params.labels.regions):null});jvm.$(c.shape).bind("selected",function(f,d){b.container.trigger("regionSelected.jvectormap",[jvm.$(this.node).attr("data-code"),d,b.getSelectedRegions()])});this.regions[a]={element:c,config:this.mapData.paths[a]}}},createMarkers:function(g){var d,c,b,f,a,e=this;this.markersGroup=this.markersGroup||this.canvas.addGroup();this.markerLabelsGroup=this.markerLabelsGroup||this.canvas.addGroup();if(jvm.$.isArray(g)){a=g.slice();g={};for(d=0;d<a.length;d++){g[d]=a[d]}}for(d in g){f=g[d] instanceof Array?{latLng:g[d]}:g[d];b=this.getMarkerPosition(f);if(b!==false){c=new jvm.Marker({map:this,style:jvm.$.extend(true,{},this.params.markerStyle,{initial:f.style||{}}),labelStyle:jvm.$.extend(true,{},this.params.markerLabelStyle),index:d,cx:b.x,cy:b.y,group:this.markersGroup,canvas:this.canvas,labelsGroup:this.markerLabelsGroup,label:this.canvas.mode!="vml"?(this.params.labels&&this.params.labels.markers):null});jvm.$(c.shape).bind("selected",function(i,h){e.container.trigger("markerSelected.jvectormap",[jvm.$(this.node).attr("data-index"),h,e.getSelectedMarkers()])});if(this.markers[d]){this.removeMarkers([d])}this.markers[d]={element:c,config:f}}}},repositionMarkers:function(){var b,a;for(b in this.markers){a=this.getMarkerPosition(this.markers[b].config);if(a!==false){this.markers[b].element.setStyle({cx:a.x,cy:a.y})}}},repositionLabels:function(){var a;for(a in this.regions){this.regions[a].element.updateLabelPosition()}for(a in this.markers){this.markers[a].element.updateLabelPosition()}},getMarkerPosition:function(a){if(jvm.Map.maps[this.params.map].projection){return this.latLngToPoint.apply(this,a.latLng||[0,0])}else{return{x:a.coords[0]*this.scale+this.transX*this.scale,y:a.coords[1]*this.scale+this.transY*this.scale}}},addMarker:function(e,a,d){var g={},f=[],b,c,d=d||[];g[e]=a;for(c=0;c<d.length;c++){b={};if(typeof d[c]!=="undefined"){b[e]=d[c]}f.push(b)}this.addMarkers(g,f)},addMarkers:function(c,b){var a;b=b||[];this.createMarkers(c);for(a=0;a<b.length;a++){this.series.markers[a].setValues(b[a]||{})}},removeMarkers:function(b){var a;for(a=0;a<b.length;a++){this.markers[b[a]].element.remove();delete this.markers[b[a]]}},removeAllMarkers:function(){var a,b=[];for(a in this.markers){b.push(a)}this.removeMarkers(b)},latLngToPoint:function(f,c){var a,d=jvm.Map.maps[this.params.map].projection,e=d.centralMeridian,b,g;if(c<(-180+e)){c+=360}a=jvm.Proj[d.type](f,c,e);b=this.getInsetForPoint(a.x,a.y);if(b){g=b.bbox;a.x=(a.x-g[0].x)/(g[1].x-g[0].x)*b.width*this.scale;a.y=(a.y-g[0].y)/(g[1].y-g[0].y)*b.height*this.scale;return{x:a.x+this.transX*this.scale+b.left*this.scale,y:a.y+this.transY*this.scale+b.top*this.scale}}else{return false}},pointToLatLng:function(h,g){var b=jvm.Map.maps[this.params.map].projection,c=b.centralMeridian,a=jvm.Map.maps[this.params.map].insets,d,k,j,f,e;for(d=0;d<a.length;d++){k=a[d];j=k.bbox;f=h-(this.transX*this.scale+k.left*this.scale);e=g-(this.transY*this.scale+k.top*this.scale);f=(f/(k.width*this.scale))*(j[1].x-j[0].x)+j[0].x;e=(e/(k.height*this.scale))*(j[1].y-j[0].y)+j[0].y;if(f>j[0].x&&f<j[1].x&&e>j[0].y&&e<j[1].y){return jvm.Proj[b.type+"_inv"](f,-e,c)}}return false},getInsetForPoint:function(a,e){var b=jvm.Map.maps[this.params.map].insets,c,d;for(c=0;c<b.length;c++){d=b[c].bbox;if(a>d[0].x&&a<d[1].x&&e>d[0].y&&e<d[1].y){return b[c]}}},createSeries:function(){var b,a;this.series={markers:[],regions:[]};for(a in this.params.series){for(b=0;b<this.params.series[a].length;b++){this.series[a][b]=new jvm.DataSeries(this.params.series[a][b],this[a],this)}}},remove:function(){this.tip.remove();this.container.remove();jvm.$(window).unbind("resize",this.onResize);jvm.$("body").unbind("mouseup",this.onContainerMouseUp)}};jvm.Map.maps={};jvm.Map.defaultParams={map:"world_mill_en",backgroundColor:"#505050",zoomButtons:true,zoomOnScroll:true,zoomOnScrollSpeed:3,panOnDrag:true,zoomMax:8,zoomMin:1,zoomStep:1.6,zoomAnimate:true,regionsSelectable:false,markersSelectable:false,bindTouchEvents:true,regionStyle:{initial:{fill:"white","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":0.8,cursor:"pointer"},selected:{fill:"yellow"},selectedHover:{}},regionLabelStyle:{initial:{"font-family":"Verdana","font-size":"12","font-weight":"bold",cursor:"default",fill:"black"},hover:{cursor:"pointer"}},markerStyle:{initial:{fill:"grey",stroke:"#505050","fill-opacity":1,"stroke-width":1,"stroke-opacity":1,r:5},hover:{stroke:"black","stroke-width":2,cursor:"pointer"},selected:{fill:"blue"},selectedHover:{}},markerLabelStyle:{initial:{"font-family":"Verdana","font-size":"12","font-weight":"bold",cursor:"default",fill:"black"},hover:{cursor:"pointer"}}};jvm.Map.apiEvents={onRegionTipShow:"regionTipShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onRegionSelected:"regionSelected",onMarkerTipShow:"markerTipShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick",onMarkerSelected:"markerSelected",onViewportChange:"viewportChange"};jvm.MultiMap=function(b){var a=this;this.maps={};this.params=jvm.$.extend(true,{},jvm.MultiMap.defaultParams,b);this.params.maxLevel=this.params.maxLevel||Number.MAX_VALUE;this.params.main=this.params.main||{};this.params.main.multiMapLevel=0;this.history=[this.addMap(this.params.main.map,this.params.main)];this.defaultProjection=this.history[0].mapData.projection.type;this.mapsLoaded={};this.params.container.css({position:"relative"});this.backButton=jvm.$("<div/>").addClass("jvectormap-goback").text("Back").appendTo(this.params.container);this.backButton.hide();this.backButton.click(function(){a.goBack()});this.spinner=jvm.$("<div/>").addClass("jvectormap-spinner").appendTo(this.params.container);this.spinner.hide()};jvm.MultiMap.prototype={addMap:function(b,a){var c=jvm.$("<div/>").css({width:"100%",height:"100%"});this.params.container.append(c);this.maps[b]=new jvm.Map(jvm.$.extend(a,{container:c}));if(this.params.maxLevel>a.multiMapLevel){this.maps[b].container.on("regionClick.jvectormap",{scope:this},function(h,g){var d=h.data.scope,f=d.params.mapNameByCode(g,d);if(!d.drillDownPromise||d.drillDownPromise.state()!=="pending"){d.drillDown(f,g)}})}return this.maps[b]},downloadMap:function(c){var b=this,a=jvm.$.Deferred();if(!this.mapsLoaded[c]){jvm.$.get(this.params.mapUrlByCode(c,this)).then(function(){b.mapsLoaded[c]=true;a.resolve()},function(){a.reject()})}else{a.resolve()}return a},drillDown:function(b,e){var a=this.history[this.history.length-1],d=this,c=a.setFocus({region:e,animate:true}),f=this.downloadMap(e);c.then(function(){if(f.state()==="pending"){d.spinner.show()}});f.always(function(){d.spinner.hide()});this.drillDownPromise=jvm.$.when(f,c);this.drillDownPromise.then(function(){a.params.container.hide();if(!d.maps[b]){d.addMap(b,{map:b,multiMapLevel:a.params.multiMapLevel+1})}else{d.maps[b].params.container.show()}d.history.push(d.maps[b]);d.backButton.show()})},goBack:function(){var a=this.history.pop(),c=this.history[this.history.length-1],b=this;a.setFocus({scale:1,x:0.5,y:0.5,animate:true}).then(function(){a.params.container.hide();c.params.container.show();c.updateSize();if(b.history.length===1){b.backButton.hide()}c.setFocus({scale:1,x:0.5,y:0.5,animate:true})})}};jvm.MultiMap.defaultParams={mapNameByCode:function(a,b){return a.toLowerCase()+"_"+b.defaultProjection+"_en"},mapUrlByCode:function(a,b){return"jquery-jvectormap-data-"+a.toLowerCase()+"-"+b.defaultProjection+"-en.js"}};